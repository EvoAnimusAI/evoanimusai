  # core/self_diagnostics.py
  # -*- coding: utf-8 -*-
> """
> M贸dulo de Diagn贸stico y Verificaci贸n de Integridad del sistema EvoAnimusAI.
> Nivel: Militar / Gubernamental / Ultra-secreto
  
> Responsabilidad:
> - Validar state cr铆tico y disponibilidad de subsistemas clave antes de iniciar cada ciclo.
> - Verificar integridad del contexto simb贸lico, configuraci贸n, rutas y seguridad.
> - Registrar fallos cr铆ticos y bloquear operaci贸n en caso de corrupci贸n o inconsistencias.
> """
  
! import logging
! import os
! from typing import Dict, Any, Optional
! from core.config import Config
  
! logger = logging.getLogger("EvoAI.Diagnostics")
  
! class SelfDiagnostics:
!     REQUIRED_COMPONENTS = ["context", "agent", "engine", "decision", "executor"]
  
!     def __init__(self, components: Optional[Dict[str, Any]] = None):
!         """
!         Inicializa el diagn贸stico con los componentes del sistema.
!         :param components: Diccionario con referencias a subsistemas cr铆ticos.
!         """
!         self.components = components or {}
  
!     def run_preflight_check(self, daemon_key: Optional[str] = None) -> bool:
!         """
!         Ejecuta chequeos cr铆ticos previos al ciclo de ejecuci贸n.
!         :param daemon_key: Clave de seguridad para validar permisos.
!         :return: True si la integridad es correcta, False en caso de fallo cr铆tico.
!         """
!         logger.info("[┖] Iniciando diagn贸stico de integridad previo al ciclo...")
  
!         try:
              # Validaci贸n de componentes cr铆ticos
!             for key in self.REQUIRED_COMPONENTS:
!                 if key not in self.components:
!                     logger.critical(f"[] Componente ausente: '{key}'. Abortando operaci贸n.")
!                     return False
!                 if self.components[key] is None:
!                     logger.critical(f"[] Componente nulo: '{key}'. Abortando operaci贸n.")
!                     return False
  
              # Validaci贸n del contexto simb贸lico
!             context = self.components.get("context")
!             if context is None:
!                 logger.critical("[] Contexto simb贸lico no definido.")
!                 return False
!             if not hasattr(context, "state") or not isinstance(context.state, dict):
!                 logger.critical("[] Contexto simb贸lico inv谩lido o corrupto.")
!                 return False
  
              # Validaci贸n de clave de seguridad (m铆nimo 12 caracteres)
!             if not daemon_key or len(daemon_key.strip()) < 12:
!                 logger.critical("[] Clave de seguridad inv谩lida o ausente.")
!                 return False
  
              # Validaci贸n de rutas cr铆ticas del sistema
!             config = Config.get_instance()
!             critical_paths = [
!                 config.symbolic_memory_path,
!                 config.mutated_functions_path,
!                 config.logs_path,
!             ]
!             for path in critical_paths:
!                 if not os.path.exists(path):
!                     logger.critical(f"[] Ruta cr铆tica no encontrada: {path}")
!                     return False
  
!             logger.info("[] Diagn贸stico completo: Integridad del sistema validada.")
!             return True
  
!         except Exception as ex:
!             logger.error(f"[] Error cr铆tico durante diagn贸stico de integridad: {ex}")
!             return False
  
  
! def run_integrity_diagnostics(context: Any) -> bool:
!     """
!     Funci贸n auxiliar para chequeo r谩pido de integridad.
!     Puede usarse en casos donde no se dispone de todos los componentes.
!     :param context: Objeto contexto simb贸lico.
!     :return: True si pasa chequeos b谩sicos, False si falla.
!     """
!     logger.info("[SelfDiagnostics] Ejecutando diagn贸stico b谩sico de integridad...")
  
!     try:
!         if context is None:
!             logger.error("[SelfDiagnostics] Contexto no definido.")
!             return False
  
!         if not hasattr(context, "state") or not isinstance(context.state, dict):
!             logger.error("[SelfDiagnostics] Estado del contexto inv谩lido o ausente.")
!             return False
  
          # Aqu铆 podr铆an a帽adirse chequeos adicionales b谩sicos...
  
!         logger.info("[SelfDiagnostics] Diagn贸stico b谩sico exitoso.")
!         return True
  
!     except Exception as e:
!         logger.error(f"[SelfDiagnostics] Error cr铆tico durante diagn贸stico: {e}")
!         return False
